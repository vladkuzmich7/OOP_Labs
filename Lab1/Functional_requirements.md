## 1. Создание холста
#### Описание: 
В момент запуска программы инициализируется объект Canvas с шириной (Width) и высотой (Height).
#### Детали:
Холст представлен двумерным массивом символов (char[,] CanvasArray), где каждый элемент соответствует точке на холсте.
Размеры холста задаются в конструкторе класса Canvas и остаются неизменными в процессе работы приложения.
При создании холст автоматически заполняется пробелами (' '), что соответствует начальному фоновому символу (CurrentBackgroundColor = ' ').
#### Реализация: 
В конструкторе Canvas(int width, int height) массив _canvasArray инициализируется и заполняется пробелами с помощью вложенных циклов.

## 2. Рисование фигур
Приложение позволяет пользователю рисовать на холсте три типа фигур: прямоугольник, круг и равнобедренный треугольник. Каждая фигура задается координатами, размерами и символом для отрисовки.

### 2.1. Прямоугольник
#### Описание: 
Пользователь может нарисовать прямоугольник, указав координаты верхней левой точки (X, Y), ширину, высоту и символ для отрисовки.
#### Детали:
Координаты (X, Y) определяют начальную точку прямоугольника.
Ширина (Width) и высота (Height) задают размеры фигуры.
Символ (Color) используется для заполнения области прямоугольника.
Если прямоугольник выходит за пределы холста, отрисовываются только те части, которые находятся внутри границ.
#### Реализация: 
Метод Draw класса Rectangle заполняет массив _canvasArray указанным символом в пределах заданных координат и размеров с проверкой границ через IsWithinCanvas.
### 2.2. Круг
#### Описание: 
Пользователь может нарисовать круг, указав координаты центра (X, Y), радиус и символ для отрисовки.
#### Детали:
Координаты (X, Y) определяют центр круга.
Радиус (Radius) задает размер круга.
Символ (Color) используется для заполнения области круга.
Круг рисуется с учетом уравнения окружности: (i - Y)^2 + (j - X)^2 <= Radius^2. Части круга, выходящие за пределы холста, не отображаются.
#### Реализация: 
Метод Draw класса Circle проверяет, попадает ли каждая точка в область круга, и заполняет массив _canvasArray символом, если точка находится внутри границ холста.
### 2.3. Равнобедренный треугольник
#### Описание: 
Пользователь может нарисовать равнобедренный треугольник, указав координаты верхней точки (X, Y), высоту и символ для отрисовки.
#### Детали:
Координаты (X, Y) задают вершину треугольника.
Высота (Height) определяет размер треугольника по вертикали.
Символ (Color) используется для заполнения области треугольника.
Ширина основания треугольника рассчитывается как 2 * (i - Y + 1) - 1 для каждой строки, чтобы обеспечить равнобедренную форму.
Части треугольника, выходящие за пределы холста, обрезаются.
#### Реализация: 
Метод Draw класса Triangle вычисляет ширину каждой строки и заполняет массив _canvasArray символом в пределах холста.
#### Общая реализация рисования
Метод DrawShape класса Canvas принимает объект Shape, вызывает его метод Draw и добавляет фигуру в список _shapes для отслеживания.
## 3. Стирание фигур
#### Описание: 
Пользователь может стереть фигуру, указав её начальные координаты (X, Y).
#### Детали:
При указании координат (X, Y) приложение ищет фигуру в списке _shapes, у которой начальные координаты совпадают с указанными (X, Y). Начальные координаты — это точка, заданная при создании фигуры (верхняя левая точка для прямоугольника, центр для круга, вершина для треугольника).
Если фигура найдена, она удаляется из списка фигур (_shapes).
После удаления холст полностью очищается, заполняясь текущим фоновым символом (CurrentBackgroundColor), чтобы убрать все следы фигур.
Затем все оставшиеся фигуры из списка _shapes перерисовываются на очищенном холсте в их текущих позициях с использованием соответствующих методов Draw.
Если фигура с указанными начальными координатами (X, Y) не найдена, пользователю выводится сообщение: "Фигура с указанными координатами не найдена. Нажмите любую клавишу...".
#### Реализация:
Метод Erase в классе Canvas использует метод Find для поиска фигуры в списке _shapes по условию s.X == x && s.Y == y, где x и y — переданные пользователем координаты.
При нахождении фигуры она удаляется из списка с помощью Shapes.Remove(shapeToErase).
Затем вызывается метод ClearCanvasWithoutShapeReset, который заполняет массив _canvasArray текущим фоновым символом.
После очистки метод Erase проходит по оставшимся фигурам в списке _shapes и вызывает для каждой из них метод Draw, чтобы восстановить их на холсте.
История действий обновляется через метод UpdateHistory, сохраняя новое состояние холста, списка фигур и фона для поддержки функций undo/redo.
#### Особенности: 
Стирание происходит строго по начальным координатам фигуры, поэтому пользователь должен точно знать координаты, заданные при создании фигуры. Части фигур, перекрытые удаляемой фигурой, полностью восстанавливаются благодаря перерисовке всех оставшихся фигур.
Если несколько фигур отрисованы с одной начальной точки, то удаляться (перемещаться) будет последняя нарисованная фигура.
## 4. Перемещение фигур
#### Описание: 
Пользователь может переместить фигуру, указав её текущие координаты (X, Y) и новые координаты (новый X, новый Y).
#### Детали:
Если фигура найдена по текущим координатам, её координаты обновляются.
Холст очищается с сохранением текущего фона, после чего все фигуры перерисовываются с новыми позициями.
В случае если фигура нарисована на "нижнем слое", то при перемещении она не появится на "верхем слое" (не перекрываю фигуру на более высоком слое).
Если фигура не найдена, пользователю выводится сообщение об ошибке.
#### Реализация: 
Метод Move находит фигуру в списке _shapes, изменяет её координаты, вызывает ClearCanvasWithoutShapeReset для очистки и перерисовывает все фигуры.
## 5. Добавление фона
#### Описание: 
Пользователь может задать символ для фона, который заполнит все пустые области холста.
#### Детали:
Новый символ фона (Color) заменяет текущий фоновый символ (CurrentBackgroundColor) во всех точках, где нет фигур.
Фигуры остаются неизменными.
#### Реализация: 
Метод AddBackground класса Canvas вызывает метод Apply класса Background, который заменяет текущий фоновый символ на новый в массиве _canvasArray.
## 6. Отмена (Undo) и возврат (Redo)
#### Описание: 
Пользователь может отменить последнее действие или вернуть отмененное действие.
#### Детали:
История действий хранит состояния холста (History), список фигур (ShapesHistory) и фоновый символ (BackgroundHistory).
Отмена (Undo) возвращает предыдущее состояние, если оно есть (CurrentStep > 0).
Возврат (Redo) переходит к следующему состоянию, если оно доступно (CurrentStep < History.Count - 1).
#### Реализация: 
Методы Undo и Redo изменяют CurrentStep и восстанавливают состояние холста, фигур и фона из соответствующих списков истории.
## 7. Сохранение и загрузка холста
#### Описание:
Пользователь может сохранить текущее состояние холста в файл и загрузить его из файла.
#### Детали:
### Сохранение:
Состояние холста сохраняется в файл в формате JSON. Сохранению подлежат текущий фоновый символ (CurrentBackgroundColor) и список фигур (Shapes), содержащий объекты всех нарисованных фигур (например, Rectangle, Circle, Triangle) с их свойствами (координаты, размеры, цвет). JSON-файл включает полные имена типов фигур для корректной десериализации.
### Загрузка:
Данные загружаются из JSON-файла, где восстанавливаются фоновый символ и список фигур. После загрузки холст очищается текущим фоновым символом, а затем все фигуры из списка перерисовываются на холсте с использованием их методов Draw. Это обеспечивает полное восстановление состояния холста, включая расположение и внешний вид фигур.
#### Реализация:
Метод Save использует JsonConvert.SerializeObject с настройками JsonSerializerSettings, включающими TypeNameHandling.All для сохранения полных имен типов фигур, и записывает результат в файл с помощью File.WriteAllText.
Метод Load читает содержимое файла с помощью File.ReadAllText, десериализует данные в объект с использованием JsonConvert.DeserializeAnonymousType и тех же настроек TypeNameHandling.All. После этого обновляет CurrentBackgroundColor и Shapes, очищает холст методом ClearCanvasWithoutShapeReset, перерисовывает все фигуры и вызывает UpdateHistory для сохранения нового состояния.
## 8. Очистка холста
#### Описание: 
Пользователь может очистить холст, удалив все фигуры и вернув его к исходному состоянию.
#### Детали:
Все элементы массива _canvasArray заполняются текущим фоновым символом.
Список фигур (_shapes) очищается.
Фоновый символ сбрасывается до пробела (' ').
#### Реализация: 
Метод ClearCanvas выполняет полную очистку холста и списка фигур.
## 9. Отображение холста
#### Описание: 
Холст отображается в консоли с учетом текущих фигур и фона.
#### Детали:
Каждая точка массива _canvasArray выводится в консоль.
Фоновый символ и символы фигур отображаются в соответствии с их значениями.
#### Реализация: 
Метод Display очищает консоль и выводит массив построчно.
## 10. Интерфейс пользователя
#### Описание: 
Приложение предоставляет текстовое меню для взаимодействия с пользователем.
#### Детали:
Меню включает 11 опций (рисование фигур, стирание, перемещение, фон, undo/redo, сохранение/загрузка, очистка, выход).
Пользователь вводит номер команды и параметры через консоль.
#### Реализация: 
В методе Main класса Program реализован цикл с выводом меню и обработкой ввода.
## 11. Обработка ошибок
#### Описание: 
Приложение обрабатывает некорректный ввод и сообщает пользователю об ошибках.
#### Детали:
Ввод чисел проверяется через int.TryParse в методе ReadInt.
Ввод символов проверяется на длину в методе ReadChar.
Проверяются границы холста через методы IsWithinCanvas.
Сообщения об ошибках выводятся при отсутствии фигуры для стирания или перемещения.
#### Реализация: 
Проверки встроены в методы ввода и обработки действий.
## 12. Управление историей действий
#### Описание: 
Приложение сохраняет историю действий для поддержки undo и redo.
#### Детали:
История обновляется после каждого действия (рисование, стирание, перемещение, добавление фона) через метод UpdateHistory.
Состояния клонируются для независимости (массив _canvasArray, список _shapes).
#### Реализация: 
Метод UpdateHistory добавляет текущее состояние в списки истории и обрезает последующие шаги.
## 13. Клонирование фигур
#### Описание: 
Фигуры поддерживают клонирование для сохранения в истории.
#### Детали:
Каждая фигура реализует абстрактный метод Clone из базового класса Shape.
#### Реализация: 
Классы Rectangle, Circle, Triangle возвращают новые экземпляры с копией своих параметров.
## 14. Ограничения
#### Описание: 
Приложение имеет ограничения на размеры холста и размещение фигур.
#### Детали:
Размеры холста фиксированы и задаются при создании.
Фигуры, выходящие за пределы холста, обрезаются (не отображаются за границами).
#### Реализация: 
Проверки границ встроены в методы Draw и Erase.
## 15. Завершение работы
#### Описание: 
Пользователь может завершить работу приложения.
#### Детали:
Выбор опции "0" в меню приводит к выходу из программы.
#### Реализация: 
В Main при выборе "0" выполняется return.
